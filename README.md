# **Настройки линтеров и форматеров в проекте.**

## Настройки линтеров в **pyproject.toml:**

1. ### Ruff (линтер + форматтер)

   * #### Совместимость с Python 3.12
   * #### Длина строки 88 символов, отступы 4 пробела
   * #### Двойные кавычки, автоформатирование докстрингов
   * #### Основные категории проверок:
     - **E** - Ошибки стиля (pycodestyle)
     - **F** - Синтаксические ошибки (Pyflakes) 
     - **W** - Предупреждения стиля (pycodestyle)
     - **UP** - Автоматическое обновление синтаксиса (pyupgrade)
     - **I** - Сортировка импортов (isort)
     - **S** - Проверки безопасности (flake8-bandit)
     - **N** - Соглашение по именованию (PEP8-naming)
     - **RUF** - Специфичные правила Ruff
     - **ASYNC** - Проверки асинхронного кода
     - **B** - Дополнительные проверки (flake8-bugbear)
     - **PL** - Стиль и ошибки (Pylint)
     - **SIM** - Упрощение кода
     - **LOG** - Проверки логирования
     - **ARG** - Неиспользуемые аргументы
     - **ANN** - Проверки аннотаций типов
     - **TRY** - Обработка исключений (tryceratops)


### 2. Игнорируемые правила

| Код      | Причина игнорирования                          |
|----------|-----------------------------------------------|
| RUF001   | Ложные срабатывания на кириллице              |
| E501     | Длина строки контролируется форматтером       |
| F401     | Неиспользуемые импорты (разрешены в __init__) |
| PLR0913  | Много аргументов в хэндлерах                  |
| ANN101   | Аннотации для self/cls не обязательны         |
| D        | Проверка докстрингов (отключена)              |


### 3. Исключения по файлам:
   * __init__.py: F401 (неиспользуемые импорты)
   * Обработчики: PLR0913/PLR0915 (много аргументов/операторов)

### 4. mypy (проверка типов)
  * Строгая проверка типов
  * Требует аннотации типов
  * Игнорирует отсутствующие импорты

## Pre-commit хуки

### Файл .pre-commit-config.yaml запускает:

  * ruff (проверка + автоисправление)
  * ruff-format (форматирование)
  * mypy (проверка типов)

### Исключенные пути:
  * .venv/, __pycache__/, .git/
  * Конфигурационные файлы (config.py, .env)
  * poetry.lock

## Основные команды
### Ручные проверки

#### Запуск всех проверок
  * pre-commit run --all-files

#### Проверки Ruff
  * ruff check . 
  * ruff check --fix .
  * ruff format .

#### Проверка типов
  * mypy .


### Во время разработки

1. #### Хуки запускаются автоматически при
   * git commit
2. #### Пропуск проверок (при необходимости):
   * git commit --no-verify -m "сообщение"
3. #### Игнорирование конкретного правила:
   * #noqa: КОД_ПРАВИЛА  # пояснение

## Стандарты качества

* #### Весь новый код должен проходить:
   * Проверку Ruff
   * Проверку типов
* #### Форматирование
* #### Исключения требуют обоснования
* #### Документирование неочевидных игнорирований

## Решение проблем

#### Если хуки не работают:
   * pre-commit clean
   * pre-commit install

#### Обновление инструментов:

poetry update --with dev